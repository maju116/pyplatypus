
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.0">
    
    
      
        <title>Platypus Engine - PyPlatypus Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-platypus-cv-engine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyPlatypus Docs" class="md-header__button md-logo" aria-label="PyPlatypus Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyPlatypus Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Platypus Engine
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyPlatypus Docs" class="md-nav__button md-logo" aria-label="PyPlatypus Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PyPlatypus Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../authors/" class="md-nav__link">
        The Creators
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../platypus_input/" class="md-nav__link">
        Platypus Input
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Platypus Engine
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Platypus Engine
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyplatypus.engine" class="md-nav__link">
    pyplatypus.engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine" class="md-nav__link">
    PlatypusEngine
  </a>
  
    <nav class="md-nav" aria-label="PlatypusEngine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine--methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models" class="md-nav__link">
    build_and_train_segmentation_models()
  </a>
  
    <nav class="md-nav" aria-label="build_and_train_segmentation_models()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.compile_u_shaped_model" class="md-nav__link">
    compile_u_shaped_model()
  </a>
  
    <nav class="md-nav" aria-label="compile_u_shaped_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.compile_u_shaped_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names" class="md-nav__link">
    get_model_names()
  </a>
  
    <nav class="md-nav" aria-label="get_model_names()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator" class="md-nav__link">
    predict_based_on_test_generator()
  </a>
  
    <nav class="md-nav" aria-label="predict_based_on_test_generator()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks" class="md-nav__link">
    produce_and_save_predicted_masks()
  </a>
  
    <nav class="md-nav" aria-label="produce_and_save_predicted_masks()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model" class="md-nav__link">
    produce_and_save_predicted_masks_for_model()
  </a>
  
    <nav class="md-nav" aria-label="produce_and_save_predicted_masks_for_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.train" class="md-nav__link">
    train()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.update_cache" class="md-nav__link">
    update_cache()
  </a>
  
    <nav class="md-nav" aria-label="update_cache()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.update_cache--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        But why?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../data_science_bowl_notebook/data_science_bowl_notebook/" class="md-nav__link">
        The Data Science Bowl Example
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyplatypus.engine" class="md-nav__link">
    pyplatypus.engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine" class="md-nav__link">
    PlatypusEngine
  </a>
  
    <nav class="md-nav" aria-label="PlatypusEngine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine--methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models" class="md-nav__link">
    build_and_train_segmentation_models()
  </a>
  
    <nav class="md-nav" aria-label="build_and_train_segmentation_models()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.compile_u_shaped_model" class="md-nav__link">
    compile_u_shaped_model()
  </a>
  
    <nav class="md-nav" aria-label="compile_u_shaped_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.compile_u_shaped_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names" class="md-nav__link">
    get_model_names()
  </a>
  
    <nav class="md-nav" aria-label="get_model_names()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.get_model_names--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator" class="md-nav__link">
    predict_based_on_test_generator()
  </a>
  
    <nav class="md-nav" aria-label="predict_based_on_test_generator()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks" class="md-nav__link">
    produce_and_save_predicted_masks()
  </a>
  
    <nav class="md-nav" aria-label="produce_and_save_predicted_masks()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model" class="md-nav__link">
    produce_and_save_predicted_masks_for_model()
  </a>
  
    <nav class="md-nav" aria-label="produce_and_save_predicted_masks_for_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.train" class="md-nav__link">
    train()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.update_cache" class="md-nav__link">
    update_cache()
  </a>
  
    <nav class="md-nav" aria-label="update_cache()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplatypus.engine.PlatypusEngine.update_cache--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="the-platypus-cv-engine">The Platypus CV Engine</h1>
<p>Overlooking the realms of this Computer Vision framework there is the mighty Engine. It is invoked by the Platypus Solver to deliver
state-of-the-art Computer Vision models, compiled, calibrated and evaluated on the course of processing a bulk payload.</p>
<p>All the engine needs is the YAML config provided by a user, which is validated on the course of parsing through the branching structure
of PlatypusSolverInput.</p>


<div class="doc doc-object doc-module">


<a id="pyplatypus.engine"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pyplatypus.engine.PlatypusEngine" class="doc doc-heading">
        <code>PlatypusEngine</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>The architecture serving the purpose of creating the data pipeline, creating and calibrating the models with the use of it
and latter predictions production.</p>
<h4 id="pyplatypus.engine.PlatypusEngine--methods">Methods</h4>
<p>train(self)
    Creates the augmentation pipeline based on the input config. Then the function performs
    the selected tasks e.g. semantic segmentation, which consists of compiling and fitting the model
    using the train and validation data generators created prior to the fitting.</p>
<p>build_and_train_segmentation_models(
    self, train_augmentation_pipeline: Optional[Compose], validation_augmentation_pipeline: Optional[Compose]
    )
    Compiles and trains the U-Shaped architecture utilized in tackling the semantic segmentation task.</p>
<p>compile_u_shaped_model(model_cfg: SemanticSegmentationModelSpec, segmentation_spec: SemanticSegmentationInput)
    Builds and compiles the U-shaped tensorflow model.</p>
<p>produce_and_save_predicted_masks(self, model_name: Optional[str] = None)
    If the name parameter is set to None, then the outputs are produced for all the trained models.
    Otherwise, the model pointed at is used.</p>
<p>produce_and_save_predicted_masks_for_model(self, model_name: str, custom_data_path: Optional[str] = None)
    For a certain model, function produces the prediction for a test data, or any data chosen by the user.
    Then these predictions are transformed into the binary masks and saved to the local files.</p>
<p>predict_based_on_test_generator(self, model_name: str, custom_data_path: Optional[str] = None):
    Produces predictions based on the selected model and the data generator created on the course of building this model.</p>
<p>get_model_names(config: dict, task: Optional[str] = "semantic_segmentation"):
    Extracts the names of all models related to the selected task.</p>


        <details class="quote">
          <summary>Source code in <code>pyplatypus/engine.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PlatypusEngine</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The architecture serving the purpose of creating the data pipeline, creating and calibrating the models with the use of it</span>
<span class="sd">    and latter predictions production.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    train(self)</span>
<span class="sd">        Creates the augmentation pipeline based on the input config. Then the function performs</span>
<span class="sd">        the selected tasks e.g. semantic segmentation, which consists of compiling and fitting the model</span>
<span class="sd">        using the train and validation data generators created prior to the fitting.</span>

<span class="sd">    build_and_train_segmentation_models(</span>
<span class="sd">        self, train_augmentation_pipeline: Optional[Compose], validation_augmentation_pipeline: Optional[Compose]</span>
<span class="sd">        )</span>
<span class="sd">        Compiles and trains the U-Shaped architecture utilized in tackling the semantic segmentation task.</span>

<span class="sd">    compile_u_shaped_model(model_cfg: SemanticSegmentationModelSpec, segmentation_spec: SemanticSegmentationInput)</span>
<span class="sd">        Builds and compiles the U-shaped tensorflow model.</span>

<span class="sd">    produce_and_save_predicted_masks(self, model_name: Optional[str] = None)</span>
<span class="sd">        If the name parameter is set to None, then the outputs are produced for all the trained models.</span>
<span class="sd">        Otherwise, the model pointed at is used.</span>

<span class="sd">    produce_and_save_predicted_masks_for_model(self, model_name: str, custom_data_path: Optional[str] = None)</span>
<span class="sd">        For a certain model, function produces the prediction for a test data, or any data chosen by the user.</span>
<span class="sd">        Then these predictions are transformed into the binary masks and saved to the local files.</span>

<span class="sd">    predict_based_on_test_generator(self, model_name: str, custom_data_path: Optional[str] = None):</span>
<span class="sd">        Produces predictions based on the selected model and the data generator created on the course of building this model.</span>

<span class="sd">    get_model_names(config: dict, task: Optional[str] = &quot;semantic_segmentation&quot;):</span>
<span class="sd">        Extracts the names of all models related to the selected task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">PlatypusSolverInput</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs Computer Vision tasks based on the certain data model, defined via the Pydantic parser.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config: PlatypusSolverInput</span>
<span class="sd">            Stores the specific task-related configs nested as its attributes e.g. to the models that are to</span>
<span class="sd">            be trained can be accessed as config.semantic_segmentation.models.</span>
<span class="sd">        cache: dict</span>
<span class="sd">            Dictionary that could be used as the handy storage for both outputs and intermediate results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">cache</span>

    <span class="k">def</span> <span class="nf">update_cache</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">u_shaped_model</span><span class="p">,</span> <span class="n">model_specification</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">generator</span><span class="p">:</span> <span class="n">SegmentationGenerator</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stores the trained model in the cache, under its name defined by a user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Comes straight from the input config.</span>
<span class="sd">        model : u_shaped_model</span>
<span class="sd">            Tensorflow model.</span>
<span class="sd">        model_specification : dict</span>
<span class="sd">            Input model configuration.</span>
<span class="sd">        generator: SegmentationGenerator</span>
<span class="sd">            Test generator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="n">model_name</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;model_specification&quot;</span><span class="p">:</span> <span class="n">model_specification</span><span class="p">,</span> <span class="s2">&quot;data_generator&quot;</span><span class="p">:</span> <span class="n">generator</span><span class="p">}</span>
            <span class="p">})</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the augmentation pipeline based on the input config. Then the function performs</span>
<span class="sd">        the selected tasks e.g. semantic segmentation, which consists of compiling and fitting the model</span>
<span class="sd">        using the train and validation data generators created prior to the fitting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cv_tasks_to_perform</span> <span class="o">=</span> <span class="n">check_cv_tasks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="n">train_augmentation_pipeline</span><span class="p">,</span> <span class="n">validation_augmentation_pipeline</span> <span class="o">=</span> <span class="n">prepare_augmentation_pipelines</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;semantic_segmentation&#39;</span> <span class="ow">in</span> <span class="n">cv_tasks_to_perform</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">semantic_segmentation</span><span class="o">=</span><span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build_and_train_segmentation_models</span><span class="p">(</span><span class="n">train_augmentation_pipeline</span><span class="p">,</span> <span class="n">validation_augmentation_pipeline</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_and_train_segmentation_models</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">train_augmentation_pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Compose</span><span class="p">],</span> <span class="n">validation_augmentation_pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Compose</span><span class="p">]</span>
            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compiles and trains the U-Shaped architecture utilized in tackling the semantic segmentation task.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        train_augmentation_pipeline : Optional[Compose]</span>
<span class="sd">            Optional augmentation pipeline, native to the albumentations package.</span>
<span class="sd">        validation_augmentation_pipeline : Optional[Compose]</span>
<span class="sd">            Optional augmentation pipeline, native to the albumentations package.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">model_cfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
            <span class="n">train_data_generator</span><span class="p">,</span> <span class="n">validation_data_generator</span><span class="p">,</span> <span class="n">test_data_generator</span> <span class="o">=</span> <span class="n">prepare_data_generators</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">spec</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">model_cfg</span><span class="o">=</span><span class="n">model_cfg</span><span class="p">,</span> <span class="n">train_augmentation_pipeline</span><span class="o">=</span><span class="n">train_augmentation_pipeline</span><span class="p">,</span>
                <span class="n">validation_augmentation_pipeline</span><span class="o">=</span><span class="n">validation_augmentation_pipeline</span>
                <span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compile_u_shaped_model</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">,</span> <span class="n">segmentation_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">train_data_generator</span><span class="p">,</span>
                <span class="n">epochs</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span>
                <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">train_data_generator</span><span class="o">.</span><span class="n">steps_per_epoch</span><span class="p">,</span>
                <span class="n">validation_data</span><span class="o">=</span><span class="n">validation_data_generator</span><span class="p">,</span>
                <span class="n">validation_steps</span><span class="o">=</span><span class="n">validation_data_generator</span><span class="o">.</span><span class="n">steps_per_epoch</span><span class="p">,</span>
                <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">ModelCheckpoint</span><span class="p">(</span>
                    <span class="n">filepath</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hdf5&#39;</span><span class="p">,</span>
                    <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>  <span class="c1"># TODO Add the monitor function and check if it is one of the metrics</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span>  <span class="c1"># TODO Is monitor supposed to be the str or our function?</span>
                <span class="p">),</span> <span class="n">EarlyStopping</span><span class="p">(</span>
                    <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_iou_coefficient&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">25</span>
                <span class="p">)]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_cache</span><span class="p">(</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">model_specification</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">),</span> <span class="n">generator</span><span class="o">=</span><span class="n">test_data_generator</span>
                <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">compile_u_shaped_model</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">:</span> <span class="n">SemanticSegmentationModelSpec</span><span class="p">,</span> <span class="n">segmentation_spec</span><span class="p">:</span> <span class="n">SemanticSegmentationInput</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Builds and compiles the U-shaped tensorflow model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_cfg : SemanticSegmentationModelSpec</span>
<span class="sd">            The model specification used for shaping the U-shaped architecture.</span>
<span class="sd">        segmentation_spec : SemanticSegmentationInput</span>
<span class="sd">            From here information such as loss function and metrics are taken.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">u_shaped_model</span><span class="p">(</span>
            <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">model</span>
        <span class="n">training_loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">prepare_loss_and_metrics</span><span class="p">(</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">n_class</span>
            <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">training_loss</span><span class="p">,</span>
            <span class="n">optimizer</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">produce_and_save_predicted_masks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If the name parameter is set to None, then the outputs are produced for all the trained models.</span>
<span class="sd">        Otherwise, the model pointed at is used.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Name of the model, should be consistent with the input config.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_names</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="n">task_type</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">produce_and_save_predicted_masks_for_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">task_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">produce_and_save_predicted_masks_for_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">task_type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">produce_and_save_predicted_masks_for_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For a certain model, function produces the prediction for a test data, or any data chosen by the user.</span>
<span class="sd">        Then these predictions are transformed into the binary masks and saved to the local files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Name of the model to use, should be consistent with the input config.</span>
<span class="sd">        custom_data_path : Optional[str], optional</span>
<span class="sd">            If provided, the data is loaded from a custom source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_based_on_test_generator</span><span class="p">(</span>
            <span class="n">model_name</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">,</span> <span class="n">task_type</span>
            <span class="p">)</span>
        <span class="n">image_masks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
            <span class="n">prediction_binary</span> <span class="o">=</span> <span class="n">transform_probabilities_into_binaries</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
            <span class="n">prediction_mask</span> <span class="o">=</span> <span class="n">concatenate_binary_masks</span><span class="p">(</span><span class="n">binary_mask</span><span class="o">=</span><span class="n">prediction_binary</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
            <span class="n">image_masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction_mask</span><span class="p">)</span>
        <span class="n">save_masks</span><span class="p">(</span><span class="n">image_masks</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict_based_on_test_generator</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Produces predictions based on the selected model and the data generator created on the course of building this model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Name of the model to use, should be consistent with the input config.</span>
<span class="sd">        custom_data_path : Optional[str], optional</span>
<span class="sd">            If provided, the data is loaded from a custom source.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        predictions: np.array</span>
<span class="sd">            Consists of the predictions for all the data yielded by the generator.</span>
<span class="sd">        paths: list</span>
<span class="sd">            Paths to the original images.</span>
<span class="sd">        colormap: List[Tuple[int, int, int]]</span>
<span class="sd">            Class color map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_generator&quot;</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">mode</span>
        <span class="k">if</span> <span class="n">custom_data_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">custom_data_path</span>
            <span class="n">g</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">create_images_masks_paths</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">only_images</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">subdirs</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">column_sep</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">steps_per_epoch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;images_paths&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">batch_size</span><span class="p">))</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">colormap</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">predict_from_generator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">mode</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_model_names</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Extracts the names of all models related to the selected task.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config : dict</span>
<span class="sd">            It is expected to be of the same form as the input config.</span>
<span class="sd">        task : Optional[str], optional</span>
<span class="sd">            Task of interest, by default &quot;semantic_segmentation&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        model_names: list</span>
<span class="sd">            Names of the models associated with the chosen task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">model_cfg</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">model_names</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs Computer Vision tasks based on the certain data model, defined via the Pydantic parser.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.__init__--parameters">Parameters</h5>

<details class="config">
  <summary>PlatypusSolverInput</summary>
  <p>Stores the specific task-related configs nested as its attributes e.g. to the models that are to
be trained can be accessed as config.semantic_segmentation.models.</p>
</details>
<details class="cache">
  <summary>dict</summary>
  <p>Dictionary that could be used as the handy storage for both outputs and intermediate results.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">PlatypusSolverInput</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs Computer Vision tasks based on the certain data model, defined via the Pydantic parser.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config: PlatypusSolverInput</span>
<span class="sd">        Stores the specific task-related configs nested as its attributes e.g. to the models that are to</span>
<span class="sd">        be trained can be accessed as config.semantic_segmentation.models.</span>
<span class="sd">    cache: dict</span>
<span class="sd">        Dictionary that could be used as the handy storage for both outputs and intermediate results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_and_train_segmentation_models</span><span class="p">(</span><span class="n">train_augmentation_pipeline</span><span class="p">,</span> <span class="n">validation_augmentation_pipeline</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Compiles and trains the U-Shaped architecture utilized in tackling the semantic segmentation task.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.build_and_train_segmentation_models--parameters">Parameters</h5>

<details class="train_augmentation_pipeline-">
  <summary>Optional[Compose]</summary>
  <p>Optional augmentation pipeline, native to the albumentations package.</p>
</details>
<details class="validation_augmentation_pipeline-">
  <summary>Optional[Compose]</summary>
  <p>Optional augmentation pipeline, native to the albumentations package.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_and_train_segmentation_models</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">train_augmentation_pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Compose</span><span class="p">],</span> <span class="n">validation_augmentation_pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Compose</span><span class="p">]</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compiles and trains the U-Shaped architecture utilized in tackling the semantic segmentation task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    train_augmentation_pipeline : Optional[Compose]</span>
<span class="sd">        Optional augmentation pipeline, native to the albumentations package.</span>
<span class="sd">    validation_augmentation_pipeline : Optional[Compose]</span>
<span class="sd">        Optional augmentation pipeline, native to the albumentations package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">model_cfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="n">train_data_generator</span><span class="p">,</span> <span class="n">validation_data_generator</span><span class="p">,</span> <span class="n">test_data_generator</span> <span class="o">=</span> <span class="n">prepare_data_generators</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spec</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">model_cfg</span><span class="o">=</span><span class="n">model_cfg</span><span class="p">,</span> <span class="n">train_augmentation_pipeline</span><span class="o">=</span><span class="n">train_augmentation_pipeline</span><span class="p">,</span>
            <span class="n">validation_augmentation_pipeline</span><span class="o">=</span><span class="n">validation_augmentation_pipeline</span>
            <span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compile_u_shaped_model</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">,</span> <span class="n">segmentation_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data_generator</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span>
            <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">train_data_generator</span><span class="o">.</span><span class="n">steps_per_epoch</span><span class="p">,</span>
            <span class="n">validation_data</span><span class="o">=</span><span class="n">validation_data_generator</span><span class="p">,</span>
            <span class="n">validation_steps</span><span class="o">=</span><span class="n">validation_data_generator</span><span class="o">.</span><span class="n">steps_per_epoch</span><span class="p">,</span>
            <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">ModelCheckpoint</span><span class="p">(</span>
                <span class="n">filepath</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hdf5&#39;</span><span class="p">,</span>
                <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>  <span class="c1"># TODO Add the monitor function and check if it is one of the metrics</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span>  <span class="c1"># TODO Is monitor supposed to be the str or our function?</span>
            <span class="p">),</span> <span class="n">EarlyStopping</span><span class="p">(</span>
                <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_iou_coefficient&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">25</span>
            <span class="p">)]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_cache</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">model_specification</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">),</span> <span class="n">generator</span><span class="o">=</span><span class="n">test_data_generator</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.compile_u_shaped_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compile_u_shaped_model</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">,</span> <span class="n">segmentation_spec</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Builds and compiles the U-shaped tensorflow model.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.compile_u_shaped_model--parameters">Parameters</h5>

<details class="model_cfg-">
  <summary>SemanticSegmentationModelSpec</summary>
  <p>The model specification used for shaping the U-shaped architecture.</p>
</details>
<details class="segmentation_spec-">
  <summary>SemanticSegmentationInput</summary>
  <p>From here information such as loss function and metrics are taken.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">compile_u_shaped_model</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">:</span> <span class="n">SemanticSegmentationModelSpec</span><span class="p">,</span> <span class="n">segmentation_spec</span><span class="p">:</span> <span class="n">SemanticSegmentationInput</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Builds and compiles the U-shaped tensorflow model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_cfg : SemanticSegmentationModelSpec</span>
<span class="sd">        The model specification used for shaping the U-shaped architecture.</span>
<span class="sd">    segmentation_spec : SemanticSegmentationInput</span>
<span class="sd">        From here information such as loss function and metrics are taken.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">u_shaped_model</span><span class="p">(</span>
        <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">model</span>
    <span class="n">training_loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">prepare_loss_and_metrics</span><span class="p">(</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">n_class</span>
        <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">training_loss</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.get_model_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_model_names</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extracts the names of all models related to the selected task.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.get_model_names--parameters">Parameters</h5>

<details class="config-">
  <summary>dict</summary>
  <p>It is expected to be of the same form as the input config.</p>
</details>
<details class="task-">
  <summary>Optional[str], optional</summary>
  <p>Task of interest, by default "semantic_segmentation"</p>
</details>      <h5 id="pyplatypus.engine.PlatypusEngine.get_model_names--returns">Returns</h5>

<details class="model_names">
  <summary>list</summary>
  <p>Names of the models associated with the chosen task.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_model_names</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Extracts the names of all models related to the selected task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config : dict</span>
<span class="sd">        It is expected to be of the same form as the input config.</span>
<span class="sd">    task : Optional[str], optional</span>
<span class="sd">        Task of interest, by default &quot;semantic_segmentation&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    model_names: list</span>
<span class="sd">        Names of the models associated with the chosen task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">model_cfg</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">model_names</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_based_on_test_generator</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Produces predictions based on the selected model and the data generator created on the course of building this model.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--parameters">Parameters</h5>

<details class="model_name-">
  <summary>str</summary>
  <p>Name of the model to use, should be consistent with the input config.</p>
</details>
<details class="custom_data_path-">
  <summary>Optional[str], optional</summary>
  <p>If provided, the data is loaded from a custom source.</p>
</details>      <h5 id="pyplatypus.engine.PlatypusEngine.predict_based_on_test_generator--returns">Returns</h5>

<details class="predictions">
  <summary>np.array</summary>
  <p>Consists of the predictions for all the data yielded by the generator.</p>
</details>
<details class="paths">
  <summary>list</summary>
  <p>Paths to the original images.</p>
</details>
<details class="colormap">
  <summary>List[Tuple[int, int, int]]</summary>
  <p>Class color map.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_based_on_test_generator</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Produces predictions based on the selected model and the data generator created on the course of building this model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        Name of the model to use, should be consistent with the input config.</span>
<span class="sd">    custom_data_path : Optional[str], optional</span>
<span class="sd">        If provided, the data is loaded from a custom source.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions: np.array</span>
<span class="sd">        Consists of the predictions for all the data yielded by the generator.</span>
<span class="sd">    paths: list</span>
<span class="sd">        Paths to the original images.</span>
<span class="sd">    colormap: List[Tuple[int, int, int]]</span>
<span class="sd">        Class color map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_generator&quot;</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">mode</span>
    <span class="k">if</span> <span class="n">custom_data_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">custom_data_path</span>
        <span class="n">g</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">create_images_masks_paths</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">only_images</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">subdirs</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">column_sep</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">steps_per_epoch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;images_paths&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">batch_size</span><span class="p">))</span>
    <span class="n">colormap</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">colormap</span>
    <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">predict_from_generator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">mode</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">produce_and_save_predicted_masks</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>If the name parameter is set to None, then the outputs are produced for all the trained models.
Otherwise, the model pointed at is used.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks--parameters">Parameters</h5>

<details class="model_name-">
  <summary>str</summary>
  <p>Name of the model, should be consistent with the input config.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">produce_and_save_predicted_masks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;If the name parameter is set to None, then the outputs are produced for all the trained models.</span>
<span class="sd">    Otherwise, the model pointed at is used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        Name of the model, should be consistent with the input config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_names</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="n">task_type</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">produce_and_save_predicted_masks_for_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">task_type</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">produce_and_save_predicted_masks_for_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">task_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">produce_and_save_predicted_masks_for_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>For a certain model, function produces the prediction for a test data, or any data chosen by the user.
Then these predictions are transformed into the binary masks and saved to the local files.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.produce_and_save_predicted_masks_for_model--parameters">Parameters</h5>

<details class="model_name-">
  <summary>str</summary>
  <p>Name of the model to use, should be consistent with the input config.</p>
</details>
<details class="custom_data_path-">
  <summary>Optional[str], optional</summary>
  <p>If provided, the data is loaded from a custom source.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">produce_and_save_predicted_masks_for_model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For a certain model, function produces the prediction for a test data, or any data chosen by the user.</span>
<span class="sd">    Then these predictions are transformed into the binary masks and saved to the local files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        Name of the model to use, should be consistent with the input config.</span>
<span class="sd">    custom_data_path : Optional[str], optional</span>
<span class="sd">        If provided, the data is loaded from a custom source.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">predictions</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_based_on_test_generator</span><span class="p">(</span>
        <span class="n">model_name</span><span class="p">,</span> <span class="n">custom_data_path</span><span class="p">,</span> <span class="n">task_type</span>
        <span class="p">)</span>
    <span class="n">image_masks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
        <span class="n">prediction_binary</span> <span class="o">=</span> <span class="n">transform_probabilities_into_binaries</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
        <span class="n">prediction_mask</span> <span class="o">=</span> <span class="n">concatenate_binary_masks</span><span class="p">(</span><span class="n">binary_mask</span><span class="o">=</span><span class="n">prediction_binary</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
        <span class="n">image_masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction_mask</span><span class="p">)</span>
    <span class="n">save_masks</span><span class="p">(</span><span class="n">image_masks</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.train" class="doc doc-heading">
<code class="highlight language-python"><span class="n">train</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates the augmentation pipeline based on the input config. Then the function performs
the selected tasks e.g. semantic segmentation, which consists of compiling and fitting the model
using the train and validation data generators created prior to the fitting.</p>

      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the augmentation pipeline based on the input config. Then the function performs</span>
<span class="sd">    the selected tasks e.g. semantic segmentation, which consists of compiling and fitting the model</span>
<span class="sd">    using the train and validation data generators created prior to the fitting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cv_tasks_to_perform</span> <span class="o">=</span> <span class="n">check_cv_tasks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
    <span class="n">train_augmentation_pipeline</span><span class="p">,</span> <span class="n">validation_augmentation_pipeline</span> <span class="o">=</span> <span class="n">prepare_augmentation_pipelines</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;semantic_segmentation&#39;</span> <span class="ow">in</span> <span class="n">cv_tasks_to_perform</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">semantic_segmentation</span><span class="o">=</span><span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_and_train_segmentation_models</span><span class="p">(</span><span class="n">train_augmentation_pipeline</span><span class="p">,</span> <span class="n">validation_augmentation_pipeline</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pyplatypus.engine.PlatypusEngine.update_cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_cache</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model_specification</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;semantic_segmentation&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Stores the trained model in the cache, under its name defined by a user.</p>
<h5 id="pyplatypus.engine.PlatypusEngine.update_cache--parameters">Parameters</h5>

<details class="model_name-">
  <summary>str</summary>
  <p>Comes straight from the input config.</p>
</details>
<details class="model-">
  <summary>u_shaped_model</summary>
  <p>Tensorflow model.</p>
</details>
<details class="model_specification-">
  <summary>dict</summary>
  <p>Input model configuration.</p>
</details>
<details class="generator">
  <summary>SegmentationGenerator</summary>
  <p>Test generator.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>pyplatypus/engine.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_cache</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">u_shaped_model</span><span class="p">,</span> <span class="n">model_specification</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">SegmentationGenerator</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;semantic_segmentation&quot;</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stores the trained model in the cache, under its name defined by a user.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        Comes straight from the input config.</span>
<span class="sd">    model : u_shaped_model</span>
<span class="sd">        Tensorflow model.</span>
<span class="sd">    model_specification : dict</span>
<span class="sd">        Input model configuration.</span>
<span class="sd">    generator: SegmentationGenerator</span>
<span class="sd">        Test generator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;model_specification&quot;</span><span class="p">:</span> <span class="n">model_specification</span><span class="p">,</span> <span class="s2">&quot;data_generator&quot;</span><span class="p">:</span> <span class="n">generator</span><span class="p">}</span>
        <span class="p">})</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../platypus_input/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Platypus Input" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Platypus Input
            </div>
          </div>
        </a>
      
      
        
        <a href="../explanation/" class="md-footer__link md-footer__link--next" aria-label="Next: But why?" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              But why?
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.48f2be22.min.js"></script>
      
    
  </body>
</html>